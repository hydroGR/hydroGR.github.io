<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Guillaume Thirel, Olivier Delaigue, Laurent Coron" />


<title>How to run airGR models</title>

<script src="site_libs/header-attrs-2.30/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
	<div class="container">
		<div class="navbar-header">
			<!-- NOTE: add "navbar-inverse" class for an alternate navbar background -->
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="index.html">airGR</a>
		</div>
		<div id="navbar" class="navbar-collapse collapse">
			<ul class="nav navbar-nav">
				<li><a href="index.html">Home</a></li>
     				<li><a href="page_1_get_started.html">Get Started</a></li>
				<li class="Download">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Articles<span class="caret"></span></a>
					<ul class="dropdown-menu">
						<li><a href="page_2.1_param_optim.html">Plugging in new calibration algorithms in airGR</a></li>
						<li><a href="page_2.2_param_mcmc.html">Parameter estimation within a Bayesian MCMC framework</a></li>
						<li><a href="page_3_param_sets_GR4J.html">Generalist parameter sets for the GR4J model</a></li>
						<li><a href="page_4_cemaneige_hysteresis.html">Using satellite snow cover area data for calibrating and improving CemaNeige</a></li>
						<li><a href="page_5_sd_model.html">Simulated vs observed upstream flows in calibration of semi-distributed GR4J model</a></li>
					</ul>
				</li>
				<li class="Download">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Download<span class="caret"></span></a>
					<ul class="dropdown-menu">
						<li><a tabindex="-1" href="https://CRAN.R-project.org/package=airGR" onclick="window.open(this.href); return false;">Package</a></li>
						<li><a tabindex="-1" href="https://CRAN.R-project.org/package=airGR/airGR.pdf" onclick="window.open(this.href); return false;">Manual</a></li>
					</ul>
				</li>
				<li><a href="NEWS.html">News</a></li>
				<li><a href="page_publications.html">Publications</a></li>
				<li><a href="page_faq.html">FAQ</a></li>
				<li class="Download">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">airGR Galaxy<span class="caret"></span></a>
					<ul class="dropdown-menu">
					  <li><a href="page_airGRgalaxy.html">Overview</a></li>
						<li><a href="https://CRAN.R-project.org/package=airGRdatasets">airGRdatasets R-package</a></li>
						<li><a href="https://CRAN.R-project.org/package=airGRdatassim">airGRdatassim R-package</a></li>
						<li><a href="https://airgriwrm.g-eau.fr/">airGRiwrm R-package</a></li>
						<li><a href="https://sunshine.inrae.fr/app/airGRmaps">airGRmaps web app</a></li>
						<li><a href="https://hydroGR.github.io/airGRteaching/">airGRteaching R-package</a></li>
						<li><a href="https://sunshine.inrae.fr/app/airGRteaching">airGRteaching web app</a></li>
					</ul>
				</li>
			</ul>
			<ul class="nav navbar-nav navbar-right">
				<a href='https://www.inrae.fr/en/' onclick="window.open(this.href); return false;", title="inrae.fr"><img src='fig/logo_inrae_CMJN_square.svg' style='width:45px;height:45px;'></a>
				<a href='https://webgr.inrae.fr/eng/' onclick="window.open(this.href); return false;", title="webgr.inrae.fr"><img src='fig/logo_inrae_hydro_CMJN_square.svg' style='width:45px;height:45px;'></a>
				<a href='https://webgr.inrae.fr/eng/tools/software/airgr' onclick="window.open(this.href); return false;", title="aiGR"><img src='fig/logo_airGR_CMJN_square.svg' style='width:45px;height:45px;'></a>
				<a href='https://gitlab.irstea.fr/HYCAR-Hydro/airgr/' onclick="window.open(this.href); return false;", title="GitLab"><img src='fig/logo_gitlab_CMJN_square.svg' style='width:45px;height:45px;'></a>				
			</ul>
		</div><!--/.nav-collapse -->
	</div><!--/.container -->
</div><!--/.navbar -->
<p style ="margin-top: 15px;">
<a href="https://CRAN.R-project.org/package=airGR"><img src="https://www.r-pkg.org/badges/version-ago/airGR" /></a>
<a href="https://www.rdocumentation.org/packages/airGR"><img src="http://cranlogs.r-pkg.org/badges/grand-total/airGR?color=orange" /></a>
<a href="https://www.r-project.org/Licenses/GPL-2">
<svg xmlns="http://www.w3.org/2000/svg" width="095" height="020">
  <linearGradient id="b" x2="0" y2="100%">
    <stop offset="0" stop-opacity=".1" stop-color="#bbb"/>
    <stop offset="1" stop-opacity=".1"/>
  </linearGradient>
  <mask id="a">
    <rect width="095" height="020" rx="3" fill="#fff" />
  </mask>
  <g mask="url(#a)">
    <path fill="#555"    d="M00 0h055v20H00z"/>
    <path fill="#00a3a6" d="M55 0h040v20H55z"/>
    <path fill="url(#b)" d="M00 0h095v20H00z"/>
  </g>
  <g fill="#fff" text-anchor="middle"
     font-family="DejaVu Sans,Verdana,Geneva,sans-serif" font-size="11">
    <text x="028" y="015" fill="#010101" fill-opacity=".3">
      License
    </text>
    <text x="028" y="014">
      License
    </text>
    <text x="075" y="015" fill="#010101" fill-opacity=".3">
      GPL 2
    </text>
    <text x="075" y="014">
      GPL 2
    </text>
  </g>
</svg>
</a>
<a href="https://doi.org/10.1016/j.envsoft.2017.05.002"><img src="https://img.shields.io/badge/doi-10.1016/j.envsoft.2017.05.002-purple.svg" /></a>
<a href="https://doi.org/10.32614/CRAN.package.airGR">              <img src="https://img.shields.io/badge/doi-10.32614/CRAN.package.airGR-purple.svg" /></a>
</p>


<div id="header">



<h1 class="title toc-ignore">How to run airGR models</h1>
<h4 class="author">Guillaume Thirel, Olivier Delaigue, Laurent
Coron</h4>

</div>


<p>This section aims at introducing to the use of
<strong><font color="#00a3a6">airGR</font></strong> through a
description of the main steps needed to make hydrological
simulations.</p>
<div id="loading-data" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Loading data</h1>
<p>In the following example, we use a data sample contained in the
package. For real applications, the user has to import its data into
<strong>R</strong> and to prepare it with an adequate data.frame format
as described below.</p>
<p>First, it is necessary to load the
<strong><font color="#00a3a6">airGR</font></strong> package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(airGR)</span></code></pre></div>
<p>Below is presented an example of a <code>data.frame</code> of daily
hydrometeorological observations time series for a fictional catchment
included in the <strong><font color="#00a3a6">airGR</font></strong>
package that contains:</p>
<ul>
<li><em>DatesR</em>: dates in the POSIXt format</li>
<li><em>P</em>: average precipitation [mm/day]</li>
<li><em>T</em>: catchment average air temperature [℃]</li>
<li><em>E</em>: catchment average potential evapotranspiration
[mm/day]</li>
<li><em>Qls</em>: outlet discharge [l/s]</li>
<li><em>Qmm</em>: outlet discharge [mm/day]</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">data</span>(L0123001)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">summary</span>(BasinObs, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##      DatesR                 P              T               E            Qls             Qmm        
##  Min.   :1984-01-01   Min.   : 0.0   Min.   :-18.7   Min.   :0.0   Min.   :   70   Min.   : 0.017  
##  1st Qu.:1991-04-02   1st Qu.: 0.0   1st Qu.:  4.1   1st Qu.:0.6   1st Qu.: 1640   1st Qu.: 0.394  
##  Median :1998-07-02   Median : 0.3   Median :  9.1   Median :1.4   Median : 4050   Median : 0.977  
##  Mean   :1998-07-02   Mean   : 2.9   Mean   :  9.1   Mean   :1.8   Mean   : 6130   Mean   : 1.473  
##  3rd Qu.:2005-10-01   3rd Qu.: 3.6   3rd Qu.: 14.5   3rd Qu.:2.9   3rd Qu.: 7850   3rd Qu.: 1.884  
##  Max.   :2012-12-31   Max.   :66.8   Max.   : 28.4   Max.   :5.5   Max.   :99500   Max.   :23.880  
##                                                                    NA&#39;s   :772     NA&#39;s   :802</code></pre>
<p>The usual functions (e.g. <code>read.table()</code>) can be used to
load real-case data sets.</p>
</div>
<div id="preparation-of-functions-inputs" class="section level1"
number="2">
<h1><span class="header-section-number">2</span> Preparation of
functions inputs</h1>
<p>To run a model, the functions of the
<strong><font color="#00a3a6">airGR</font></strong> package (e.g. the
models, calibration and criteria calculation functions) require data and
options with specific formats.</p>
<p>To facilitate the use of the package, there are several functions
dedicated to the creation of these objects:</p>
<ul>
<li><code>CreateInputsModel()</code>: prepares the inputs for the
different hydrological models (times series of dates, precipitation,
observed discharge, etc.)</li>
<li><code>CreateRunOptions()</code>: prepares the options for the
hydrological model run (warm up period, calibration period, etc.)</li>
<li><code>CreateInputsCrit()</code>: prepares the options in order to
compute the efficiency criterion (choice of the criterion, choice of the
transformation on discharge: “log”, “sqrt”, etc.)</li>
<li><code>CreateCalibOptions()</code>: prepares the options for the
hydrological model calibration algorithm (choice of parameters to
optimize, predefined values for uncalibrated parameters, etc.)</li>
</ul>
<div id="inputsmodel-object" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> InputsModel
object</h2>
<p>To run a GR hydrological model or CemaNeige, the user has to prepare
the input data with the <code>CreateInputsModel()</code> function. As
arguments, this function needs the function name corresponding to the
model the user wants to run, a vector of dates, a vector of
precipitation and a vector of potential evapotranspiration.</p>
<p>In the example below, we already have the potential
evapotranspiration. If the user does not have these data, it is possible
to compute it with the <a
href="http://dx.doi.org/10.1016/j.jhydrol.2004.08.026">Oudin’s
formula</a> with the <code>PE_Oudin()</code> function (this function
only needs Julian days, daily average air temperature and latitude).</p>
<p>Missing values (<code>NA</code>) of precipitation (or potential
evapotranspiration) are <strong>not allowed</strong>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>InputsModel <span class="ot">&lt;-</span> <span class="fu">CreateInputsModel</span>(<span class="at">FUN_MOD =</span> RunModel_GR4J, <span class="at">DatesR =</span> BasinObs<span class="sc">$</span>DatesR,</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                                 <span class="at">Precip =</span> BasinObs<span class="sc">$</span>P, <span class="at">PotEvap =</span> BasinObs<span class="sc">$</span>E)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">str</span>(InputsModel)</span></code></pre></div>
<pre><code>## List of 3
##  $ DatesR : POSIXlt[1:10593], format: &quot;1984-01-01&quot; &quot;1984-01-02&quot; &quot;1984-01-03&quot; ...
##  $ Precip : num [1:10593] 4.1 15.9 0.8 0 0 0 0 0 2.9 0 ...
##  $ PotEvap: num [1:10593] 0.2 0.2 0.3 0.3 0.1 0.3 0.4 0.4 0.5 0.5 ...
##  - attr(*, &quot;FeatFUN_MOD&quot;)=List of 11
##   ..$ CodeMod     : chr &quot;GR4J&quot;
##   ..$ NameMod     : chr &quot;GR4J&quot;
##   ..$ NbParam     : int 4
##   ..$ TimeUnit    : chr &quot;daily&quot;
##   ..$ Id          : logi NA
##   ..$ Class       : chr [1:2] &quot;daily&quot; &quot;GR&quot;
##   ..$ Pkg         : chr &quot;airGR&quot;
##   ..$ NameFunMod  : chr &quot;RunModel_GR4J&quot;
##   ..$ TimeStep    : num 86400
##   ..$ TimeStepMean: int 86400
##   ..$ CodeModHydro: chr &quot;GR4J&quot;
##  - attr(*, &quot;class&quot;)= chr [1:3] &quot;InputsModel&quot; &quot;daily&quot; &quot;GR&quot;</code></pre>
</div>
<div id="runoptions-object" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> RunOptions
object</h2>
<p>The <code>CreateRunOptions()</code> function allows to prepare the
options required to the <code>RunModel*()</code> functions, which are
the actual models functions.</p>
<p>The user must at least define the following arguments:</p>
<ul>
<li><code>FUN_MOD</code>: the name of the model function to run</li>
<li><code>InputsModel</code>: the associated input data</li>
<li><code>IndPeriod_Run</code>: the period on which the model is
run</li>
</ul>
<p>To select a period for which the user wants to run the model, select
the corresponding indexes for different time periods (not the POSIXt
dates), as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>Ind_Run <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">which</span>(<span class="fu">format</span>(BasinObs<span class="sc">$</span>DatesR, <span class="at">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>) <span class="sc">==</span> <span class="st">&quot;1990-01-01&quot;</span>), </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>               <span class="fu">which</span>(<span class="fu">format</span>(BasinObs<span class="sc">$</span>DatesR, <span class="at">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>) <span class="sc">==</span> <span class="st">&quot;1999-12-31&quot;</span>))</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">str</span>(Ind_Run)</span></code></pre></div>
<pre><code>##  int [1:3652] 2193 2194 2195 2196 2197 2198 2199 2200 2201 2202 ...</code></pre>
<p>The initialization of hydrological models is of the utmost
importance. Indeed, an inaccurate initialization causes poor quality
discharge simulations during the earliest stages of the running period.
For example, in the GR models, by default, the production and the
routing store levels store level are respectively set to 30 % and 50 %
of their capacity, which may be far from their ideal value. Two
solutions are offered to accurately initialize the GR models in
<strong><font color="#00a3a6">airGR</font></strong>: manually
predefining the initial states (e.g. from a previous run) or running the
models during a warm up period before the actual running period. It is
generally advised to set up this warm up period to be equal or superior
to one year.</p>
<p>As a consequence, it is possible to define in
<code>CreateRunOptions()</code> the following arguments:</p>
<ul>
<li><code>IniStates</code>: the initial states of the 2 unit hydrographs
(20 + 40 = 60 units)</li>
<li><code>IniResLevels</code>: the initial levels of the production and
routing stores</li>
<li><code>IndPeriod_WarmUp</code>: the warm up period used to run the
model, to be defined in the same format as
<code>IndPeriod_Run</code></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>RunOptions <span class="ot">&lt;-</span> <span class="fu">CreateRunOptions</span>(<span class="at">FUN_MOD =</span> RunModel_GR4J,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                               <span class="at">InputsModel =</span> InputsModel, <span class="at">IndPeriod_Run =</span> Ind_Run,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                               <span class="at">IniStates =</span> <span class="cn">NULL</span>, <span class="at">IniResLevels =</span> <span class="cn">NULL</span>, <span class="at">IndPeriod_WarmUp =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<pre><code>## Warning in CreateRunOptions(FUN_MOD = RunModel_GR4J, InputsModel = InputsModel, : model warm up period not defined: default configuration used
##   the year preceding the run period is used</code></pre>
<pre><code>## Warning in CreateIniStates(FUN_MOD = FUN_MOD, InputsModel = InputsModel, : &#39;RunModel_GR4J&#39; does not require
## &#39;ExpStore&#39;. Value set to NA</code></pre>
<pre><code>## Warning in CreateIniStates(FUN_MOD = FUN_MOD, InputsModel = InputsModel, : &#39;RunModel_GR4J&#39; does not require
## &#39;IntStore&#39;. Values set to NA</code></pre>
<pre><code>## Warning in CreateIniStates(FUN_MOD = FUN_MOD, InputsModel = InputsModel, : &#39;RunModel_GR4J&#39; does not require
## &#39;GCemaNeigeLayers&#39; &#39;GCemaNeigeLayers&#39;, &#39;GthrCemaNeigeLayers&#39; and &#39;GlocmaxCemaNeigeLayers&#39;. Values set to NA</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">str</span>(RunOptions)</span></code></pre></div>
<pre><code>## List of 8
##  $ IndPeriod_WarmUp: int [1:365] 1828 1829 1830 1831 1832 1833 1834 1835 1836 1837 ...
##  $ IndPeriod_Run   : int [1:3652] 2193 2194 2195 2196 2197 2198 2199 2200 2201 2202 ...
##  $ IniStates       : Named num [1:71] 350 90 0 0 0 0 0 0 0 0 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:71] &quot;Store.Prod&quot; &quot;Store.Rout&quot; &quot;Store.Exp&quot; &quot;Store.Int&quot; ...
##  $ IniResLevels    : num [1:4] 0.3 0.5 NA NA
##  $ Outputs_Cal     : chr [1:2] &quot;Qsim&quot; &quot;Param&quot;
##  $ Outputs_Sim     : Named chr [1:22] &quot;DatesR&quot; &quot;PotEvap&quot; &quot;Precip&quot; &quot;Prod&quot; ...
##   ..- attr(*, &quot;names&quot;)= chr [1:22] &quot;&quot; &quot;GR1&quot; &quot;GR2&quot; &quot;GR3&quot; ...
##  $ FortranOutputs  :List of 2
##   ..$ GR: chr [1:18] &quot;PotEvap&quot; &quot;Precip&quot; &quot;Prod&quot; &quot;Pn&quot; ...
##   ..$ CN: NULL
##  $ FeatFUN_MOD     :List of 12
##   ..$ CodeMod     : chr &quot;GR4J&quot;
##   ..$ NameMod     : chr &quot;GR4J&quot;
##   ..$ NbParam     : int 4
##   ..$ TimeUnit    : chr &quot;daily&quot;
##   ..$ Id          : logi NA
##   ..$ Class       : chr [1:2] &quot;daily&quot; &quot;GR&quot;
##   ..$ Pkg         : chr &quot;airGR&quot;
##   ..$ NameFunMod  : chr &quot;RunModel_GR4J&quot;
##   ..$ TimeStep    : num 86400
##   ..$ TimeStepMean: int 86400
##   ..$ CodeModHydro: chr &quot;GR4J&quot;
##   ..$ IsSD        : logi FALSE
##  - attr(*, &quot;class&quot;)= chr [1:3] &quot;RunOptions&quot; &quot;daily&quot; &quot;GR&quot;</code></pre>
<p>The <code>CreateRunOptions()</code> function returns warnings if the
default initialization options are used:</p>
<ul>
<li><code>IniStates</code> and <code>IniResLevels</code> are
automatically set to initialize all the model states at 0, except for
the production and routing stores, which are initialized at respectively
30 % and 50 % of their capacity</li>
<li><code>IndPeriod_WarmUp</code> default setting ensures a one-year
warm up using the time steps preceding the <code>IndPeriod_Run</code>,
if available</li>
</ul>
</div>
<div id="inputscrit-object" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> InputsCrit
object</h2>
<p>The <code>CreateInputsCrit()</code> function allows to prepare the
input in order to calculate a criterion. It is possible to define the
following arguments:</p>
<ul>
<li><code>FUN_CRIT</code>: the name of the error criterion function (the
available functions are introduced later on)</li>
<li><code>InputsModel</code>: the inputs of the hydrological model
previously prepared by the <code>CreateInputsModel()</code>
function</li>
<li><code>RunOptions</code>: the options of the hydrological model
previously prepared by the <code>CreateRunOptions()</code> function</li>
<li><code>VarObs</code>: the name of the considered variable (by default
<code>"Q"</code> for the discharge)</li>
<li><code>Obs</code>: the observed variable time serie (e.g. the
discharge expressed in <em>mm/time step</em>)</li>
</ul>
<p>Missing values (<code>NA</code>) are <strong>allowed</strong> for
observed discharge.</p>
<p>It is possible to compute a composite criterion (e.g. the average
between NSE computed on discharge and NSE computed on log of discharge).
In this case, users have to provide lists to the following arguments
(some of the are optional): <code>FUN_CRIT</code>, <code>Obs</code>,
<code>VarObs</code>, <code>BoolCrit</code>, <code>transfo</code>,
<code>Weights.</code></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>InputsCrit <span class="ot">&lt;-</span> <span class="fu">CreateInputsCrit</span>(<span class="at">FUN_CRIT =</span> ErrorCrit_NSE, <span class="at">InputsModel =</span> InputsModel, </span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>                               <span class="at">RunOptions =</span> RunOptions, <span class="at">VarObs =</span> <span class="st">&quot;Q&quot;</span>, <span class="at">Obs =</span> BasinObs<span class="sc">$</span>Qmm[Ind_Run])</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">str</span>(InputsCrit)</span></code></pre></div>
<pre><code>## List of 8
##  $ FUN_CRIT:function (InputsCrit, OutputsModel, warnings = TRUE, verbose = TRUE)  
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;FUN_CRIT&quot; &quot;function&quot;
##  $ Obs     : num [1:3652] 1.99 1.8 2.86 2.4 3.31 ...
##  $ VarObs  : chr &quot;Q&quot;
##  $ BoolCrit: logi [1:3652] TRUE TRUE TRUE TRUE TRUE TRUE ...
##  $ idLayer : logi NA
##  $ transfo : chr &quot;&quot;
##  $ epsilon : NULL
##  $ Weights : NULL
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;Single&quot; &quot;InputsCrit&quot;</code></pre>
</div>
<div id="caliboptions-object" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> CalibOptions
object</h2>
<p>Before using the automatic calibration tool, the user needs to
prepare the calibration options with the
<code>CreateCalibOptions()</code> function. For that, it is necessary to
define the following arguments:</p>
<ul>
<li><code>FUN_MOD</code>: the name of the model function</li>
<li><code>FUN_CALIB</code>: the name of the calibration algorithm</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>CalibOptions <span class="ot">&lt;-</span> <span class="fu">CreateCalibOptions</span>(<span class="at">FUN_MOD =</span> RunModel_GR4J, <span class="at">FUN_CALIB =</span> Calibration_Michel)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">str</span>(CalibOptions)</span></code></pre></div>
<pre><code>## List of 4
##  $ FixedParam       : logi [1:4] NA NA NA NA
##  $ SearchRanges     : num [1:2, 1:4] 4.59e-05 2.18e+04 -1.09e+04 1.09e+04 4.59e-05 ...
##  $ FUN_TRANSFO      :function (ParamIn, Direction)  
##  $ StartParamDistrib: num [1:3, 1:4] 169.017 247.151 432.681 -2.376 -0.649 ...
##  - attr(*, &quot;class&quot;)= chr [1:4] &quot;CalibOptions&quot; &quot;daily&quot; &quot;GR&quot; &quot;HBAN&quot;</code></pre>
</div>
</div>
<div id="criteria" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Criteria</h1>
<p>The evaluation of the quality of a simulation is estimated through
the calculation of criteria. These criteria can be used both as
objective-functions during the calibration of the model, or as a measure
for evaluating its performance on a control period.</p>
<p>The package offers the possibility to use different criteria:</p>
<ul>
<li><code>ErrorCrit_RMSE()</code>: Root mean square error (RMSE)</li>
<li><code>ErrorCrit_NSE()</code>: Nash-Sutcliffe model efficiency
coefficient (NSE)</li>
<li><code>ErrorCrit_KGE()</code>: Kling-Gupta efficiency criterion
(KGE)</li>
<li><code>ErrorCrit_KGE2()</code>: modified Kling-Gupta efficiency
criterion (KGE’)</li>
</ul>
<p>It is also possible to create user-defined criteria. For doing that,
it is only necessary to define the function in <strong>R</strong>
following the same syntax as the criteria functions included in
<strong><font color="#00a3a6">airGR</font></strong>.</p>
</div>
<div id="calibration" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Calibration</h1>
<p>The objective of the calibration algorithm is to identify the model
parameters: by comparing the model outputs with observed data, this
algorithm determines the combination of parameters that represents the
best the behavior of the watershed.</p>
<p>In the <strong><font color="#00a3a6">airGR</font></strong> package, a
function called <code>Calibration_Michel()</code> is implemented. This
functions allows running a calibration with the package models. The
calibration algorithm optimizes the error criterion selected as
objective-function. This algorithm works in two steps:</p>
<ol style="list-style-type: decimal">
<li>a screening of the parameters space is performed using either a
rough predefined grid or a user-defined list of parameter sets</li>
<li>a simple steepest descent local search algorithm is performed from
the best set of parameters found at the first step</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>OutputsCalib <span class="ot">&lt;-</span> <span class="fu">Calibration_Michel</span>(<span class="at">InputsModel =</span> InputsModel, <span class="at">RunOptions =</span> RunOptions,</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>                                   <span class="at">InputsCrit =</span> InputsCrit, <span class="at">CalibOptions =</span> CalibOptions,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>                                   <span class="at">FUN_MOD =</span> RunModel_GR4J)</span></code></pre></div>
<pre><code>## Grid-Screening in progress (0% 20% 40% 60% 80% 100%)
##   Screening completed (81 runs)
##       Param =  247.151,   -0.020,   83.096,    2.384
##       Crit. NSE[Q]       = 0.7688
## Steepest-descent local search in progress
##   Calibration completed (21 iterations, 234 runs)
##       Param =  257.238,    1.012,   88.235,    2.208
##       Crit. NSE[Q]       = 0.7988</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>Param <span class="ot">&lt;-</span> OutputsCalib<span class="sc">$</span>ParamFinalR</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>Param</span></code></pre></div>
<pre><code>## [1] 257.237556   1.012237  88.234673   2.207958</code></pre>
<p>The <code>Calibration_Michel()</code> function is the only one
implemented in the <strong><font color="#00a3a6">airGR</font></strong>
package to calibrate the model, but the user can implement its own
calibration function.</p>
<p>The <code>Calibration_Michel()</code> function returns a vector with
the parameters of the chosen model, which means that the number of
values can differ depending on the model that is used. It is possible to
use the <code>Calibration_Michel()</code> function with user-implemented
hydrological models.</p>
</div>
<div id="control" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Control</h1>
<p>This step assesses the predictive capacity of the model. Control is
defined as the estimation of the accuracy of the model on data sets that
are not used in its construction, and in particular its calibration. The
classical way to perform a control is to keep data from a period
separated from the calibration period. If possible, this control period
should correspond to climatic situations that differ from those of the
calibration period in order to better point out the qualities and
weaknesses of the model. This exercise is necessary for assessing the
robustness of the model, that is to say its ability to keep stable
performances outside of the calibration conditions.</p>
<p>Performing a model control with
<strong><font color="#00a3a6">airGR</font></strong> is similar to
running a simulation (see below), followed by the computation of one or
several performance criteria.</p>
</div>
<div id="simulation" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Simulation</h1>
<div id="simulation-run" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Simulation run</h2>
<p>To run a model, the user has to use the <code>RunModel*()</code>
functions (<code>InputsModel</code>, <code>RunOptions</code> and
parameters). All the data needed have already been prepared in the
previous steps defined in this guide.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>OutputsModel <span class="ot">&lt;-</span> <span class="fu">RunModel_GR4J</span>(<span class="at">InputsModel =</span> InputsModel, <span class="at">RunOptions =</span> RunOptions, <span class="at">Param =</span> Param)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">str</span>(OutputsModel)</span></code></pre></div>
<pre><code>## List of 21
##  $ DatesR    : POSIXlt[1:3652], format: &quot;1990-01-01&quot; &quot;1990-01-02&quot; &quot;1990-01-03&quot; ...
##  $ PotEvap   : num [1:3652] 0.3 0.4 0.4 0.3 0.1 0.1 0.1 0.2 0.2 0.3 ...
##  $ Precip    : num [1:3652] 0 9.3 3.2 7.3 0 0 0 0 0.1 0.2 ...
##  $ Prod      : num [1:3652] 196 199 199 201 200 ...
##  $ Pn        : num [1:3652] 0 8.9 2.8 7 0 0 0 0 0 0 ...
##  $ Ps        : num [1:3652] 0 3.65 1.12 2.75 0 ...
##  $ AE        : num [1:3652] 0.2833 0.4 0.4 0.3 0.0952 ...
##  $ Perc      : num [1:3652] 0.645 0.696 0.703 0.74 0.725 ...
##  $ PR        : num [1:3652] 0.645 5.946 2.383 4.992 0.725 ...
##  $ Q9        : num [1:3652] 1.78 1.52 3.86 3.17 3.45 ...
##  $ Q1        : num [1:3652] 0.2 0.195 0.271 0.387 0.365 ...
##  $ Rout      : num [1:3652] 53.9 53.6 55.3 56.1 56.9 ...
##  $ Exch      : num [1:3652] 0.181 0.18 0.177 0.197 0.207 ...
##  $ AExch1    : num [1:3652] 0.181 0.18 0.177 0.197 0.207 ...
##  $ AExch2    : num [1:3652] 0.181 0.18 0.177 0.197 0.207 ...
##  $ AExch     : num [1:3652] 0.362 0.36 0.353 0.393 0.414 ...
##  $ QR        : num [1:3652] 2.05 1.99 2.36 2.55 2.78 ...
##  $ QD        : num [1:3652] 0.381 0.375 0.447 0.584 0.572 ...
##  $ Qsim      : num [1:3652] 2.43 2.37 2.8 3.14 3.35 ...
##  $ RunOptions:List of 2
##   ..$ WarmUpQsim: num [1:365] 0.779 0.815 0.807 0.731 0.675 ...
##   ..$ Param     : num [1:4] 257.24 1.01 88.23 2.21
##  $ StateEnd  :List of 3
##   ..$ Store          :List of 5
##   .. ..$ Prod: num 189
##   .. ..$ Rout: num 48.9
##   .. ..$ Exp : num NA
##   .. ..$ Int : num NA
##   .. ..$ Rest: num [1:3] NA NA NA
##   ..$ UH             :List of 2
##   .. ..$ UH1: num [1:20] 0.514 0.54 0.148 0 0 ...
##   .. ..$ UH2: num [1:40] 0.056306 0.057176 0.042253 0.012187 0.000578 ...
##   ..$ CemaNeigeLayers:List of 4
##   .. ..$ G      : num NA
##   .. ..$ eTG    : num NA
##   .. ..$ Gthr   : num NA
##   .. ..$ Glocmax: num NA
##   ..- attr(*, &quot;class&quot;)= chr [1:3] &quot;IniStates&quot; &quot;daily&quot; &quot;GR&quot;
##  - attr(*, &quot;class&quot;)= chr [1:3] &quot;OutputsModel&quot; &quot;daily&quot; &quot;GR&quot;</code></pre>
</div>
<div id="results-preview" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Results preview</h2>
<p>Although it is possible for the user to design its own graphics from
the outputs of the <code>RunModel*()</code> functions, the
<strong><font color="#00a3a6">airGR</font></strong> package offers the
possibility to make use of the <code>plot()</code> function. This
function returns a dashboard of results including various graphs
(depending on the model used):</p>
<ul>
<li>time series of total precipitation and simulated discharge (and
observed discharge if provided)</li>
<li>interannual average daily simulated discharge (and daily observed
discharge if provided) and interannual average monthly
precipitation</li>
<li>cumulative frequency plot for simulated discharge (and for observed
discharge if provided)</li>
<li>correlation plot between simulated and observed discharge (if
observed discharge provided)</li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">plot</span>(OutputsModel, <span class="at">Qobs =</span> BasinObs<span class="sc">$</span>Qmm[Ind_Run])</span></code></pre></div>
<p><img src="page_1_get_started_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Moreover, if the CemaNeige model is used, the air temperature and the
simulated snowpack water equivalent time series are plotted.</p>
</div>
<div id="efficiency-criterion" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Efficiency
criterion</h2>
<p>To evaluate the efficiency of the model, it is possible to use the
same criterion as defined at the calibration step or to use another
criterion.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>OutputsCrit <span class="ot">&lt;-</span> <span class="fu">ErrorCrit_NSE</span>(<span class="at">InputsCrit =</span> InputsCrit, <span class="at">OutputsModel =</span> OutputsModel)</span></code></pre></div>
<pre><code>## Crit. NSE[Q] = 0.7988</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="fu">str</span>(OutputsCrit)</span></code></pre></div>
<pre><code>## List of 5
##  $ CritValue      : num 0.799
##  $ CritName       : chr &quot;NSE[Q]&quot;
##  $ CritBestValue  : num 1
##  $ Multiplier     : num -1
##  $ Ind_notcomputed: int [1:57] 2405 2406 2407 2408 2409 2410 2411 2412 2413 2414 ...
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;NSE&quot; &quot;ErrorCrit&quot;</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>OutputsCrit <span class="ot">&lt;-</span> <span class="fu">ErrorCrit_KGE</span>(<span class="at">InputsCrit =</span> InputsCrit, <span class="at">OutputsModel =</span> OutputsModel)</span></code></pre></div>
<pre><code>## Crit. KGE[Q] = 0.7854</code></pre>
<pre><code>##  SubCrit. KGE[Q] cor(sim, obs, &quot;pearson&quot;) = 0.8985 
##  SubCrit. KGE[Q] sd(sim)/sd(obs)          = 0.8161 
##  SubCrit. KGE[Q] mean(sim)/mean(obs)      = 1.0437</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">str</span>(OutputsCrit)</span></code></pre></div>
<pre><code>## List of 7
##  $ CritValue      : num 0.785
##  $ CritName       : chr &quot;KGE[Q]&quot;
##  $ SubCritValues  : num [1:3] 0.898 0.816 1.044
##  $ SubCritNames   : chr [1:3] &quot;r&quot; &quot;alpha&quot; &quot;beta&quot;
##  $ CritBestValue  : num 1
##  $ Multiplier     : num -1
##  $ Ind_notcomputed: int [1:57] 2405 2406 2407 2408 2409 2410 2411 2412 2413 2414 ...
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;KGE&quot; &quot;ErrorCrit&quot;</code></pre>
</div>
<div id="features-diagram" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Features diagram</h2>
<p>The figure below presents the implementation flow of the
<strong><font color="#00a3a6">airGR</font></strong> functions. <br><br>
<img src="fig/airGR_features_diagram.svg" alt="airGR features diagram" width=75% /></p>
</div>
</div>

<footer>
  <div style="float:left"><img src="fig/logo_republique_francaise_CMJN.svg" alt="airGR logo" height=50px style="margin-top:-20px" /></div>
  <div style="float:right">Developed by INRAE&nbsp;<a href="https://webgr.inrae.fr/eng/">Catchment Hydrology Research Group</a>&nbsp;&#x2013; Antony, France</div>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
