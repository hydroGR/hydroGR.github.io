<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Pierre Brigode &amp; Olivier Delaigue" />


<title>Prévision de bas débits</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/united.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
	<div class="container">
		<div class="navbar-header">
			<!-- NOTE: add "navbar-inverse" class for an alternate navbar background -->
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="index.html">airGRteaching</a>
		</div>
		<div id="navbar" class="navbar-collapse collapse">
			<ul class="nav navbar-nav">
				<li><a href="index.html">Home</a></li>
				<li><a href="page_1_get_started_airGRteaching.html">Get Started</a></li>
                <li class="Download">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Exercises<span class="caret"></span></a>
					<ul class="dropdown-menu">
						<li class="dropdown-header">Introduction    </li>
                        <li><a href="page_exo_v00_teaching_hydrology.html"    >Teaching hydrology with airGRteaching        </a></li>
                        <li class="divider"></li>
                        <li class="dropdown-header">English versions</li>
                        <li><a href="page_exo_v01_EN_flow_reconstruction.html">1. Streamflow reconstruction                               </a></li>
						<li><a href="page_exo_v02_EN_flow_forecasting.html"   >2. Low-flow forecasting                                    </a></li>
						<li><a href="page_exo_v03_EN_impact_CC_flow.html"     >3. Impact of climate change on streamflow regime           </a></li>
                        <li class="divider"></li>
                        <li class="dropdown-header">French versions</li>
						<li><a href="page_exo_v01_FR_flow_reconstruction.html">1. Reconstitution de débits                                </a></li>
						<li><a href="page_exo_v02_FR_flow_forecasting.html"   >2. Prévision de bas débits                                 </a></li>
						<li><a href="page_exo_v03_FR_impact_CC_flow.html"     >3. Impact du changement climatique sur le régime des débits</a></li>
					</ul>
				</li>
				<li class="Download">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Download<span class="caret"></span></a>
					<ul class="dropdown-menu">
						<li><a tabindex="-1" href="https://CRAN.R-project.org/package=airGRteaching" onclick="window.open(this.href); return false;">Package</a></li>
						<li><a tabindex="-1" href="https://CRAN.R-project.org/package=airGRteaching/airGRteaching.pdf" onclick="window.open(this.href); return false;">Manual</a></li>
					</ul>
				</li>
				<li><a href="NEWS.html">News</a></li>
				<li><a href="page_publications.html">Publications</a></li>				
				<li><a href="page_faq.html">FAQ</a></li>
				<li class="Download">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">airGR Galaxy<span class="caret"></span></a>
					<ul class="dropdown-menu">
						<li><a href="https://hydroGR.github.io/airGR/">airGR R-package</a></li>
						<li><a href="https://CRAN.R-project.org/package=airGRdatasets">airGRdatasets R-package</a></li>
						<li><a href="https://CRAN.R-project.org/package=airGRdatassim">airGRdatassim R-package</a></li>
						<li><a href="https://airgriwrm.g-eau.fr/">airGRiwrm R-package</a></li>
						<li><a href="https://sunshine.inrae.fr/app/airGRmaps">airGRmaps web app</a></li>
					</ul>
				</li>
				<li><a tabindex="-1" href="https://sunshine.inrae.fr/app/airGRteaching" onclick="window.open(this.href); return false;">GUI Demo</a></li>
			</ul>
			<ul class="nav navbar-nav navbar-right">
				<a href='http://www.inrae.fr/en/' onclick="window.open(this.href); return false;", title="inrae.fr"><img src='fig/logo_inrae_CMJN_square.svg' style='width:45px;height:45px;'></a>
				<a href='https://webgr.inrae.fr/eng/' onclick="window.open(this.href); return false;", title="webgr.inrae.fr"><img src='fig/logo_inrae_hydro_CMJN_square.svg' style='width:45px;height:45px;'></a>
				<a href='https://webgr.inrae.fr/software/airgrteaching/' onclick="window.open(this.href); return false;", title="aiGRteaching"><img src='fig/logo_airGRteaching_CMJN_square.png' style='width:45px;height:45px;'></a>
				<a href='https://gitlab.irstea.fr/HYCAR-Hydro/airgrteaching/' onclick="window.open(this.href); return false;", title="GitLab"><img src='fig/logo_gitlab_CMJN_square.svg' style='width:45px;height:45px;'></a>
			</ul>
		</div><!--/.nav-collapse -->
	</div><!--/.container -->
</div><!--/.navbar -->
<p style ="margin-top: 15px;">
<a href="https://CRAN.R-project.org/package=airGRteaching"><img src="https://www.r-pkg.org/badges/version-ago/airGRteaching" /></a>
<a href="https://www.rdocumentation.org/packages/airGRteaching"><img src="http://cranlogs.r-pkg.org/badges/grand-total/airGRteaching?color=orange" /></a>
<a href="https://www.r-project.org/Licenses/GPL-2">
<svg xmlns="http://www.w3.org/2000/svg" width="095" height="020">
  <linearGradient id="b" x2="0" y2="100%">
    <stop offset="0" stop-opacity=".1" stop-color="#bbb"/>
    <stop offset="1" stop-opacity=".1"/>
  </linearGradient>
  <mask id="a">
    <rect width="095" height="020" rx="3" fill="#fff" />
  </mask>
  <g mask="url(#a)">
    <path fill="#555"    d="M00 0h055v20H00z"/>
    <path fill="#00a3a6" d="M55 0h040v20H55z"/>
    <path fill="url(#b)" d="M00 0h095v20H00z"/>
  </g>
  <g fill="#fff" text-anchor="middle"
     font-family="DejaVu Sans,Verdana,Geneva,sans-serif" font-size="11">
    <text x="028" y="015" fill="#010101" fill-opacity=".3">
      License
    </text>
    <text x="028" y="014">
      License
    </text>
    <text x="075" y="015" fill="#010101" fill-opacity=".3">
      GPL 2
    </text>
    <text x="075" y="014">
      GPL 2
    </text>
  </g>
</svg>
</a>
<a href="https://doi.org/10.5194/hess-27-3293-2023"><img src="https://img.shields.io/badge/doi-10.5194/hess--27--3293--2023-purple.svg" /></a>
<a href="https://doi.org/10.32614/CRAN.package.airGRteaching"><img src="https://img.shields.io/badge/doi-10.32614/CRAN.package.airGRteaching-purple.svg" /></a>

<!--
<div class="htmlwigetsWarning" style="background-color:#0B9DA0;color:white;padding:10px;">
<b>
Warning:
</b>
<br>
The <b>airGRteaching Shiny GUI</b> launched by the 'ShinyGR' function is sometimes unstable on latest versions of <b>RStudio</b>
<br>
<b>It is better to launch the GUI from the Rgui or from R into a terminal</b>
<br>
</div>

<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">mirror &lt;-<span class="st"> &quot;https://cran.r-project.org/src/contrib/Archive/htmlwidgets&quot;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">install.packages</span>(<span class="dt">pkgs =</span> <span class="kw">file.path</span>(mirror, <span class="st">&quot;htmlwidgets_1.3.tar.gz&quot;</span>),</a>
<a class="sourceLine" id="cb2-3" title="3">                 <span class="dt">repos =</span> <span class="ot">NULL</span>, <span class="dt">type =</span> <span class="st">&quot;source&quot;</span>)</a></code></pre></div>
</div>
-->
</p>


<div id="header">



<h1 class="title toc-ignore">Prévision de bas débits</h1>
<h4 class="author">Pierre Brigode &amp; Olivier Delaigue</h4>

</div>


<div id="énoncé" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Énoncé</h1>
<div id="contexte" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Contexte</h2>
<p>Fin de l’été 2018, la La Meuse à Saint-Mihiel a atteint son niveau le
plus bas depuis plusieurs années et les précipitations se font toujours
attendre sur ce bassin versant caractérisé par de nombreux usages de
l’eau en cette période estivale. En charge de la surveillance des débits
en période d’étiage, vous venez d’être appelé.e par les élus du Syndicat
intercommunal qui s’affolent de la situation de sécheresse et vous
demandent de produire une estimation des débits de la rivière pour les
prochaines semaines.</p>
<p>Malheureusement, vous ne recevez plus les prévisions météorologiques
du service de prévision de la région depuis plusieurs semaines… Vous ne
disposez donc d’aucune prévision des précipitations à venir, mais devez
tout de même quantifier les débits possibles sur les prochaines semaines
sur le bassin versant.</p>
<p>L’exercice consiste donc à utiliser les données hydro-climatiques
disponibles (au pas de temps journalier) sur le bassin versant La Meuse
à Saint-Mihiel (2543 km²), et un modèle pluie-débit pour prévoir les
débits des semaines à venir en utilisant (1) le dernier débit observé
sur le bassin versant considéré, (2) l’historique des précipitations
observées et (3) l’historique des débits observés. Ces informations
permettront d’obtenir des fourchettes de débits potentiels pour les
semaines à venir (cf. figure suivante).</p>
<p>Ce travail sera réalisé en quatre étapes :</p>
<ol style="list-style-type: decimal">
<li>Analyse statistique de la <em>climatologie des débits</em> pour
avoir un ordre de grandeur des débits historiquement observés durant la
période d’étude, i.e. le régime des débits journaliers.</li>
<li>Calage du modèle hydrologique sur la période historique en
considérant un critère centré sur les bas débits.</li>
<li>Scénario pessimiste de <em>précipitations nulles</em> : simulation
pluie-débit sur l’été étudié à partir du dernier débit observé en ne
considérant aucune précipitation à venir et une série
d’évapotranspiration potentielle (ETP) constituée à partir des ETP
moyennes interannuelles.</li>
<li>Scénarios de <em>précipitations futures non nulles</em> :
simulations pluie-débit sur l’été étudié à partir du dernier débit
observé en “rejouant” la <em>climatologie des précipitations</em>,
i.e. les précipitations observées durant les autres étés. Il y aura donc
autant de simulations à faire que d’années historiques passées.</li>
</ol>
<p><img src="figure/V02_fig_presentation-1.png" width="98%" /></p>
</div>
<div id="consignes" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Consignes</h2>
<p>Cette section vise à expliciter certaines tâches attendues et à
décrire les conditions de calage et de simulation du modèle hydrologique
(période de calage des paramètres, périodes d’initialisation des
réservoirs, critère de calage, etc.).</p>
<div id="analyse-de-la-climatologie-des-débits" class="section level3"
number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Analyse de la
climatologie des débits</h3>
<p>Dans un contexte de prévision hydrologique, la “climatologie des
débits” désigne le régime des débits, i.e. la série de débits moyens
interannuels. Si l’on veut prévoir le débit du jour à venir (par exemple
le 1 septembre), la prévision la plus “simple” d’un point de vue
technique consiste en effet à calculer la moyenne des débits observés en
ce même jour lors des années passées (donc l’ensemble des débits
observés les 1<sup>er</sup> septembre des années passées). Cette moyenne
peut également être encadrée grâce aux calculs de quantiles de ces mêmes
débits historiques (par exemple les quantiles 10 et 90 %), ce qui permet
d’avoir une première estimation “probabiliste” des débits futurs, sans
réaliser de modélisation pluie-débit et sans utiliser de prévision de
précipitations.</p>
<p>Dans cet exercice, il s’agit d’analyser l’ensemble des débits
observés sur la période de prévision ( 1 septembre 2018 au 20 octobre
2018) lors des années précédentes. 20 années sont disponibles pour cette
analyse, ce qui permet de constituer 20 séries de débits journaliers
historiques pour la période de prévision. Une fois regroupés dans un
même tableau, ces débits peuvent être résumés grâce au calcul, pour
chaque journée considérée, de quantiles tels que les quantiles 10, 25,
50, 75 et 90 %. Ces quantiles seront ensuite utilisés comme première
estimation des débits futurs.</p>
</div>
<div id="modèle-pluie-débit" class="section level3" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Modèle
pluie-débit</h3>
<p>Vous utiliserez le modèle GR6J <span class="citation">(Pushpalatha et
al. 2011)</span>. Il s’agit d’un modèle pluie-débit global, fonctionnant
au pas de temps journalier et possédant six paramètres. Il nécessite en
entrée des séries temporelles continues de précipitations et
d’évapotranspirations potentielles (ETP) journalières.</p>
<p>Ce modèle est utilisable facilement grâce au package
<strong><font color="#0BA6AA">airGRteaching</font></strong> <span
class="citation">(Delaigue et al. 2024, 2023)</span>, développé pour le
<a href="https://cran.r-project.org/">logiciel R</a> par l’<a
href="https://webgr.inrae.fr/">équipe Hydrologie des bassins versants de
l’unité de recherche HYCAR</a> (<a
href="https://www.inrae.fr/">INRAE</a>, France).</p>
<p>Les séries temporelles de précipitations, d’ETP et de débits peuvent
être facilement mises en forme grâce à la fonction
<code>PrepGR()</code>. On peut réaliser une simulation pluie-débit grâce
à la fonction <code>SimGR()</code> et un calage des paramètres grâce à
la fonction <code>CalGR()</code>.</p>
</div>
<div id="période-de-calage-et-dinitialisation" class="section level3"
number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Période de calage
(et d’initialisation)</h3>
<p>L’initialisation est particulièrement importante dans un contexte de
prévision hydrologique par modélisation : cette initialisation consiste
ainsi à estimer l’état de saturation du bassin (i.e. les états internes
du modèle) qui va ensuite être utilisé comme conditions initiales pour
tous les scénarios testés. Ces scénarios partent donc tous d’un même
état à la date de lancement des prévisions.</p>
<p>La période à considérer pour caler les paramètres du modèle sur le
bassin versant de la La Meuse à Saint-Mihiel débute le 1 septembre 2000
et s’achève le 31 août 2018. Une période d’initialisation de 20 mois
doit également être considérée du 1 janvier 1999 au 31 août 2000.</p>
</div>
<div id="critère-de-calage" class="section level3" number="1.2.4">
<h3><span class="header-section-number">1.2.4</span> Critère de
calage</h3>
<p>Le critère de calage considéré dans cet exercice est le critère de
Nash et Sutcliffe <span class="citation">(Nash and Sutcliffe
1970)</span> calculé sur les logarithmes népériens des débits, noté
<span class="math inline">\(NSE\)</span> par la suite (cf. équation
suivante). Ce critère est largement utilisé en modélisation
hydrologique.</p>
<p>Le critère NSE, borné entre <span
class="math inline">\(-\infty\)</span> et <span
class="math inline">\(1\)</span>, permet de quantifier la performance
d’un modèle de manière relative, en comparant une série de débits
simulés avec un modèle dit “naïf”, ici la moyenne des débits observés
(i.e. une série de débits constituée en chaque pas de temps par la
moyenne des débits observés). Ainsi, une valeur de NSE égale à 1
signifie une concordance parfaite entre les séries de débits observés et
simulés (ce qui n’est jamais le cas), alors qu’une valeur de NSE
inférieure à 0 signifie que la simulation considérée est moins
performante que la simulation du modèle “naïf”. Le calcul de <span
class="math inline">\(NSE_{ln}\)</span> est détaillé dans l’équation
suivante, dans laquelle <span class="math inline">\(Q_{obs,t}\)</span>
est le débit observé au pas de temps <span
class="math inline">\(t\)</span>, <span
class="math inline">\(Q_{sim,t}\)</span> est le débit simulé au pas de
temps <span class="math inline">\(t\)</span>, <span
class="math inline">\(\overline{Q_{obs}}\)</span> est la moyenne des
débits observés, <span class="math inline">\(\epsilon\)</span> est une
constante définie ci-après, et <span class="math inline">\(n\)</span>
est le nombre d’observations :</p>
<p><span class="math display">\[\begin{equation}
NSE_{ln} =
1-\frac{\sum_{t=1}^{n}(ln(Q_{obs,t}+\epsilon)-ln(Q_{sim,t}+\epsilon))^{2}}{\sum_{t=1}^{n}(ln(Q_{obs,t}+\epsilon)-\overline{ln(Q_{obs}+\epsilon)})^{2}}
\end{equation}\]</span></p>
<p>Le calcul de la valeur d’<span
class="math inline">\(\epsilon\)</span> est détaillé dans l’équation
suivante. L’ajout de cet <span class="math inline">\(\epsilon\)</span>
est nécessaire lorsque des débits nuls sont présents dans la série de
débits observés.</p>
<p><span class="math display">\[\begin{equation}
\epsilon=\frac{\overline{Q_{obs}}}{100}
\end{equation}\]</span></p>
<p>La transformation logarithmique permet de mettre plus de poids sur
les débits les plus faibles et donc de limiter les erreurs commises sur
la simulation des étiages <span class="citation">(Ludovic Oudin et al.
2006)</span>. Considérer une série constituée par l’inverse des débits
lors du calage est également recommandé pour obtenir de bonnes
performances lors de la simulation des très bas débits <span
class="citation">(Pushpalatha et al. 2012)</span>.</p>
<p>Les différents éléments nécessaires pour le calcul du critère de
calage doivent être renseignés en argument de la fonction
<code>CalGR()</code>, ce qui permet notamment de spécifier si le critère
doit être calculé sur des débits “transformés” avec l’argument
<code>transfo</code> (ici égal à <code>log</code>).</p>
</div>
<div id="calage-automatique-des-paramètres-du-modèle"
class="section level3" number="1.2.5">
<h3><span class="header-section-number">1.2.5</span> Calage automatique
des paramètres du modèle</h3>
<p>L’estimation automatique de paramètres vise à utiliser un algorithme
automatique qui va générer automatiquement des jeux de paramètres, les
tester, et en générer d’autres en fonction des performances de ceux
d’ores et déjà testés. L’algorithme développé par <span
class="citation">Michel (1991)</span> sera utilisé dans cet
exercice.</p>
</div>
<div id="période-de-simulation" class="section level3" number="1.2.6">
<h3><span class="header-section-number">1.2.6</span> Période de
simulation</h3>
<p>La période de simulation, qui peut également être appelée période de
prévision dans cet exercice, s’étale du 1 septembre 2018 au 20 octobre
2018. L’ensemble des pas de temps précédant cette période de calage peut
être utilisé comme période d’initialisation.</p>
</div>
<div id="scénario-pessimiste-de-précipitations-nulles"
class="section level3" number="1.2.7">
<h3><span class="header-section-number">1.2.7</span> Scénario pessimiste
de <em>précipitations nulles</em></h3>
<p>Avoir un modèle pluie-débit calé sur le bassin versant étudié permet
d’utiliser des scénarios de précipitations futures et de les transformer
en scénarios de débits. Le scénario le plus simple à tester (et le plus
pessimiste) est le scénario dit de “précipitations nulles” : aucune
précipitation ne sera observée sur les pas de temps de la période de
prévision. Il s’agira ainsi de la borne basse de la prévision par
modélisation pluie-débit.</p>
<p>Pour mettre en place ce scénario dans l’environnement
d’<strong><font color="#0BA6AA">airGRteaching</font></strong>, il faut
créer un tableau de données fictives contenant une série temporelle de
précipitations égales à 0 sur l’étendue de la période de prévision. Pour
l’ETP, une hypothèse réaliste est d’utiliser le régime interannuel de
cette variable. Ainsi, pour chaque journée de prévision, la valeur
moyenne interannuelle des ETP observées sera utilisée : l’ETP du 1
septembre de ce scénario sera égal à la moyenne des valeurs d’ETP
observées pour l’ensemble des 1 septembre.</p>
</div>
<div id="scénario-de-précipitations-futures-non-nulles"
class="section level3" number="1.2.8">
<h3><span class="header-section-number">1.2.8</span> Scénario de
<em>précipitations futures non nulles</em></h3>
<p>Cette dernière étape vise à réaliser plusieurs simulations
pluie-débit en considérant des scénarios de précipitations futures non
nulles. Ces scénarios de précipitations seront construits à partir de
l’historique des précipitations. 20 années passées sont disponibles pour
cette analyse, ce qui permet de constituer 20 séries de précipitations
et d’ETP journalières historiques pour la période de prévision. Une
simulation pluie-débit sera réalisée pour chacune de ces années passées,
en débutant la simulation par la même période d’initialisation. Une fois
regroupés dans un même tableau, les débits simulés pourront être résumés
grâce au calcul, pour chaque journée considérée, de quantiles tels que
les quantiles 10, 25, 50, 75 et 90 %. Ces quantiles seront ensuite
utilisés comme indication des possibles débits futurs.</p>
</div>
</div>
<div id="données-disponibles" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Données
disponibles</h2>
<p>Les données disponibles pour la modélisation pluie-débit sont les
suivantes :</p>
<ul>
<li>une chronique journalière de précipitations totales (liquides +
solides) [mm/jour] (<code>Ptot</code>);</li>
<li>une chronique journalière d’ETP calculée grâce à la formule d’<span
class="citation">L. Oudin et al. (2005, mm/jour)</span>
(<code>Evap</code>);</li>
<li>une chronique journalière de débits exprimés en lame d’eau [mm/jour]
(<code>Qmmd</code>).</li>
</ul>
</div>
</div>
<div id="éléments-de-correction" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Éléments de
correction</h1>
<div id="chargement-et-mise-en-forme-des-données" class="section level2"
number="2.1">
<h2><span class="header-section-number">2.1</span> Chargement et mise en
forme des données</h2>
<p>Les lignes de codes présentées ci-après permettent de lire les
données nécessaires au calage du modèle pluie-débit et de définir les
périodes temporelles de travail (période d’initialisation, période de
calage et période de prévision) :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Calibration period</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>per_cal_hist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;2000-09-01&quot;</span>, <span class="st">&quot;2018-08-31&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># Forecasting period</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>per_fcst <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;2018-09-01&quot;</span>, <span class="st">&quot;2018-10-20&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># Warm-up period to simulate on the historical period </span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>per_wup_hist <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;1999-01-01&quot;</span>, <span class="st">&quot;2000-08-31&quot;</span>)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co"># Warm-up period to simulate on the forcasting period</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>per_wup_fcst <span class="ot">&lt;-</span> <span class="fu">c</span>(per_wup_hist[<span class="dv">1</span>], per_cal_hist[<span class="dv">2</span>])</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="co"># Forecasting dates</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>dates_fcst <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">as.POSIXct</span>(per_fcst[<span class="dv">1</span>], <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>, <span class="at">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>), </span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>                  <span class="at">to   =</span> <span class="fu">as.POSIXct</span>(per_fcst[<span class="dv">2</span>], <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>, <span class="at">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>), </span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>                  <span class="at">by   =</span> <span class="st">&quot;1 day&quot;</span>)</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="fu">head</span>(dates_fcst)</span></code></pre></div>
<pre><code>## [1] &quot;2018-09-01 UTC&quot; &quot;2018-09-02 UTC&quot; &quot;2018-09-03 UTC&quot; &quot;2018-09-04 UTC&quot; &quot;2018-09-05 UTC&quot; &quot;2018-09-06 UTC&quot;</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Formatting of forecast dates (Month-Day)</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>month_day_fcst <span class="ot">&lt;-</span> <span class="fu">format</span>(dates_fcst, <span class="st">&quot;%m-%d&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">head</span>(month_day_fcst)</span></code></pre></div>
<pre><code>## [1] &quot;09-01&quot; &quot;09-02&quot; &quot;09-03&quot; &quot;09-04&quot; &quot;09-05&quot; &quot;09-06&quot;</code></pre>
<div id="initial-time-series" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Initial time
series</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Catchment data loading</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">library</span>(airGRdatasets)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;B222001001&quot;</span>, <span class="at">package =</span> <span class="st">&quot;airGRdatasets&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co"># Catchment area</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>area <span class="ot">&lt;-</span> B222001001<span class="sc">$</span>Meta<span class="sc">$</span>Area</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="co"># Observed daily time series</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>ts_init <span class="ot">&lt;-</span> B222001001<span class="sc">$</span>TS</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co"># Add date information to the time series</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>ts_init<span class="sc">$</span>Year     <span class="ot">&lt;-</span> <span class="fu">format</span>(ts_init<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">&quot;%Y&quot;</span>)</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>ts_init<span class="sc">$</span>MonthDay <span class="ot">&lt;-</span> <span class="fu">format</span>(ts_init<span class="sc">$</span>Date, <span class="at">format =</span> <span class="st">&quot;%m-%d&quot;</span>)</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co"># Display of the 1st time steps of the time series</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="fu">head</span>(ts_init)</span></code></pre></div>
<pre><code>##             Date Ptot Temp Evap   Qls  Qmmd Year MonthDay
## 14764 1999-01-01  0.1  3.0  0.3 33100 1.124 1999    01-01
## 14765 1999-01-02  5.8  5.5  0.4 31400 1.067 1999    01-02
## 14766 1999-01-03  5.3  5.6  0.4 30700 1.043 1999    01-03
## 14767 1999-01-04  1.2  9.1  0.5 32200 1.094 1999    01-04
## 14768 1999-01-05  0.0  9.1  0.5 41600 1.413 1999    01-05
## 14769 1999-01-06  0.1  7.2  0.5 44100 1.498 1999    01-06</code></pre>
</div>
<div id="ploted-time-series" class="section level3" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Ploted time
series</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Set values of the last winter to missing data</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>ts_plot <span class="ot">&lt;-</span> ts_init</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>isd_wint <span class="ot">&lt;-</span> ts_plot<span class="sc">$</span>Date <span class="sc">&gt;=</span> <span class="fu">as.POSIXct</span>(per_fcst[<span class="dv">1</span>], <span class="at">tz =</span> <span class="st">&quot;UTC&quot;</span>, <span class="at">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>ts_plot[isd_wint, <span class="fu">c</span>(<span class="st">&quot;Ptot&quot;</span>, <span class="st">&quot;Temp&quot;</span>, <span class="st">&quot;Evap&quot;</span>, <span class="st">&quot;Qls&quot;</span>, <span class="st">&quot;Qmmd&quot;</span>)] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co"># Display of the last time steps of the time series</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="fu">tail</span>(ts_plot)</span></code></pre></div>
<pre><code>##             Date Ptot Temp Evap Qls Qmmd Year MonthDay
## 22063 2018-12-26   NA   NA   NA  NA   NA 2018    12-26
## 22064 2018-12-27   NA   NA   NA  NA   NA 2018    12-27
## 22065 2018-12-28   NA   NA   NA  NA   NA 2018    12-28
## 22066 2018-12-29   NA   NA   NA  NA   NA 2018    12-29
## 22067 2018-12-30   NA   NA   NA  NA   NA 2018    12-30
## 22068 2018-12-31   NA   NA   NA  NA   NA 2018    12-31</code></pre>
</div>
<div id="observed-time-series" class="section level3" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Observed time
series</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Select the time series over the observed period (no &quot;future&quot; dates)</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>ts_hist <span class="ot">&lt;-</span> ts_plot[ts_plot<span class="sc">$</span>Date <span class="sc">&lt;</span> dates_fcst[<span class="dv">1</span>], ]</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># Display of the last time steps of the time series</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="fu">tail</span>(ts_hist)</span></code></pre></div>
<pre><code>##             Date Ptot Temp Evap  Qls  Qmmd Year MonthDay
## 21941 2018-08-26  0.1 13.4  2.5 2910 0.099 2018    08-26
## 21942 2018-08-27  0.6 16.5  2.9 3040 0.103 2018    08-27
## 21943 2018-08-28  0.0 18.3  3.1 3140 0.107 2018    08-28
## 21944 2018-08-29 14.6 17.1  2.9 3170 0.108 2018    08-29
## 21945 2018-08-30  0.7 15.1  2.6 3330 0.113 2018    08-30
## 21946 2018-08-31  0.7 13.8  2.4 3220 0.109 2018    08-31</code></pre>
</div>
<div id="forecast-time-series" class="section level3" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Forecast time
series</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># Select the time series after the observed period (only &quot;future&quot; dates)</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>ts_fcst <span class="ot">&lt;-</span> ts_plot[ts_plot<span class="sc">$</span>Date <span class="sc">&gt;=</span> dates_fcst[<span class="dv">1</span>] <span class="sc">&amp;</span> ts_plot<span class="sc">$</span>Date <span class="sc">&lt;=</span> dates_fcst[<span class="fu">length</span>(dates_fcst)], ]</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># Display of the 1st time steps of the time series</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="fu">head</span>(ts_fcst)</span></code></pre></div>
<pre><code>##             Date Ptot Temp Evap Qls Qmmd Year MonthDay
## 21947 2018-09-01   NA   NA   NA  NA   NA 2018    09-01
## 21948 2018-09-02   NA   NA   NA  NA   NA 2018    09-02
## 21949 2018-09-03   NA   NA   NA  NA   NA 2018    09-03
## 21950 2018-09-04   NA   NA   NA  NA   NA 2018    09-04
## 21951 2018-09-05   NA   NA   NA  NA   NA 2018    09-05
## 21952 2018-09-06   NA   NA   NA  NA   NA 2018    09-06</code></pre>
</div>
</div>
<div id="analyse-de-la-climatologie-des-débits-1" class="section level2"
number="2.2">
<h2><span class="header-section-number">2.2</span> Analyse de la
climatologie des débits</h2>
<p>Les lignes de codes présentées ci-après permettent d’analyser la
climatologie des débits en calculant les quantiles de débits
interannuels sur la période de prévision :</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Calculation of the historical streamflow quantiles</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>ts_qclim_quant <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Qmmd <span class="sc">~</span> MonthDay, </span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>                            <span class="at">data =</span> ts_hist[ts_hist<span class="sc">$</span>MonthDay <span class="sc">%in%</span> month_day_fcst, ], </span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>                            <span class="at">FUN =</span> <span class="cf">function</span>(x) {</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>                              <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">0.90</span>))</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>                            })</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>ts_qclim_quant <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ts_qclim_quant<span class="sc">$</span>Qmmd)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="fu">colnames</span>(ts_qclim_quant) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Q&quot;</span>, <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">D&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">colnames</span>(ts_qclim_quant)))</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="fu">rownames</span>(ts_qclim_quant) <span class="ot">&lt;-</span> month_day_fcst</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co"># Display of the 1st calculated quantiles</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="fu">head</span>(ts_qclim_quant)</span></code></pre></div>
<pre><code>##          Q10    Q25   Q50    Q75    Q90
## 09-01 0.0736 0.0965 0.120 0.1925 0.2930
## 09-02 0.0786 0.0990 0.118 0.1850 0.2888
## 09-03 0.0790 0.0985 0.114 0.1770 0.2900
## 09-04 0.0806 0.0955 0.110 0.1925 0.3016
## 09-05 0.0762 0.0905 0.109 0.1885 0.3138
## 09-06 0.0748 0.0870 0.107 0.2000 0.3154</code></pre>
<p>La climatologie des débits permet d’obtenir un premier ordre de
grandeur des débits possibles des prochains jours (cf. figure suivante),
mais ne permet pas de rendre compte des derniers débits observés.</p>
<p><img src="figure/v02_fig_qclim-1.png" width="98%" /></p>
</div>
<div id="préparation-des-données-pour-gr6j" class="section level2"
number="2.3">
<h2><span class="header-section-number">2.3</span> Préparation des
données pour GR6J</h2>
<p>Les lignes de codes présentées ci-après visent à préparer les données
disponibles pour leur utilisation par GR6J, grâce à la fonction
<code>PrepGR()</code> du package
<strong><font color="#0BA6AA">airGRteaching</font></strong>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Adding an epsilon to observed streamflows for criterion calculation</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>epsilon_qobs <span class="ot">&lt;-</span> <span class="fu">mean</span>(ts_hist<span class="sc">$</span>Qmmd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">100</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co"># Data processing for GR6J</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>prep_hist <span class="ot">&lt;-</span> <span class="fu">PrepGR</span>(<span class="at">DatesR     =</span> ts_hist<span class="sc">$</span>Date,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>                    <span class="at">Precip     =</span> ts_hist<span class="sc">$</span>Ptot,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>                    <span class="at">PotEvap    =</span> ts_hist<span class="sc">$</span>Evap, </span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>                    <span class="at">Qobs       =</span> ts_hist<span class="sc">$</span>Qmmd <span class="sc">+</span> epsilon_qobs,</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>                    <span class="at">HydroModel =</span> <span class="st">&quot;GR6J&quot;</span>, </span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>                    <span class="at">CemaNeige  =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
<div id="calage-de-gr6j-sur-la-période-historique"
class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Calage de GR6J sur la
période historique</h2>
<p>Les lignes de codes présentées ci-après permettent de caler le modèle
GR6J sur la période historique.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># Calibration step</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>cal_hist <span class="ot">&lt;-</span> <span class="fu">CalGR</span>(<span class="at">PrepGR  =</span> prep_hist, </span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>                  <span class="at">CalCrit =</span> <span class="st">&quot;NSE&quot;</span>,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>                  <span class="at">WupPer  =</span> per_wup_hist, </span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>                  <span class="at">CalPer  =</span> per_cal_hist,</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>                  <span class="at">transfo =</span> <span class="st">&quot;log&quot;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>                  <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Grid-Screening in progress (0% 20% 40% 60% 80% 100%)
##   Screening completed (729 runs)
##       Param =   49.402,   -0.521,  148.413,    2.345,    0.020,   20.086
##       Crit. NSE[log(Q)]  = 0.9176
## Steepest-descent local search in progress
##   Calibration completed (58 iterations, 1427 runs)
##       Param =  195.102,   -0.374,   27.227,    4.470,    0.291,    9.093
##       Crit. NSE[log(Q)]  = 0.9638</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># Get parameter and criterion values</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>param_cal_hist <span class="ot">&lt;-</span> <span class="fu">GetParam</span>(cal_hist)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>crit_cal_hist <span class="ot">&lt;-</span> <span class="fu">GetCrit</span>(cal_hist)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co"># Graphical assessment of the calibration performance</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="fu">plot</span>(cal_hist)</span></code></pre></div>
<p><img src="figure/v02_fig_step_cal_hist-1.png" width="98%" /></p>
<p>Les six paramètres et la valeur du critère de calage (<span
class="math inline">\(NSE_{ln}\)</span>) obtenus après la procédure de
calage automatique sont :</p>
<ul>
<li>X1 = 195 [mm]</li>
<li>X2 = -0.374 [mm/j]</li>
<li>X3 = 27 [mm]</li>
<li>X4 = 4.47 [j]</li>
<li>X5 = 0.291 [-]</li>
<li>X6 = 9.09 [mm]</li>
<li><span class="math inline">\(NSE_{ln}\)</span> = 0.964 [-]</li>
</ul>
<p>Les performances obtenues en calage sont très bonnes, puisque le
critère <span class="math inline">\(NSE_{ln}\)</span> est égal à
0.964.</p>
<p>Les lignes de codes présentées ci-après permettent de stocker dans un
même tableau les débits observés et les débits simulés avec le jeu de
paramètres obtenu par calage automatique, afin de les comparer.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># Combination of observed and simulated streamflow time series on the calibration period</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>ts_cal_hist <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(cal_hist)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">head</span>(ts_cal_hist)</span></code></pre></div>
<pre><code>##        Dates PotEvap PrecipObs PrecipFracSolid_CemaNeige TempMeanSim_CemaNeige     Qobs      Qsim
## 1 2000-09-01     2.6       6.6                        NA                    NA 0.270145 0.2240305
## 2 2000-09-02     2.2      13.8                        NA                    NA 0.275145 0.2211849
## 3 2000-09-03     2.2       3.2                        NA                    NA 0.280145 0.2265360
## 4 2000-09-04     2.0       0.2                        NA                    NA 0.297145 0.2440921
## 5 2000-09-05     2.0       0.0                        NA                    NA 0.318145 0.2887186
## 6 2000-09-06     2.2       8.2                        NA                    NA 0.363145 0.3087389</code></pre>
<p>La figure suivante représente les séries de débits observés et
simulés sur la fin de la période de calage.</p>
<p><img src="figure/v02_fig_cal_hist-1.png" width="98%" /></p>
</div>
<div id="scénario-pessimiste-de-précipitations-nulles-1"
class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Scénario pessimiste
de <em>précipitations nulles</em></h2>
<p>Les lignes de codes présentées ci-après permettent de créer une
chronique de données “fictives” regroupant des données observées (pour
l’initialisation du modèle) et des données créées pour le scénario de
“précipitations nulles”. Cette chonique sera ensuite utilisé en entrée
du modèle GR6J pour “transformer” ce scénario météorologique en scénario
hydrologique.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># Duplicate the table with future dates to fill the forecast period</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>ts_fcst_p0 <span class="ot">&lt;-</span> ts_fcst</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co"># Setting zero precipitation for the forecast period</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>ts_fcst_p0<span class="sc">$</span>Ptot <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co"># Addition of interannual average PE</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>ts_eclim <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(Evap <span class="sc">~</span> MonthDay, </span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>                      <span class="at">data =</span> ts_hist[ts_hist<span class="sc">$</span>MonthDay <span class="sc">%in%</span> month_day_fcst, ], </span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>                      <span class="at">FUN =</span> mean)</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>ts_fcst_p0<span class="sc">$</span>Evap <span class="ot">&lt;-</span> ts_eclim<span class="sc">$</span>Evap</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co"># Combine historical and forecasting time series</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>ts_scen_p0 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ts_hist, ts_fcst_p0)</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="co"># Display of the last lines</span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="fu">tail</span>(ts_scen_p0)</span></code></pre></div>
<pre><code>##             Date Ptot Temp      Evap Qls Qmmd Year MonthDay
## 21991 2018-10-15    0   NA 1.0526316  NA   NA 2018    10-15
## 21992 2018-10-16    0   NA 1.0473684  NA   NA 2018    10-16
## 21993 2018-10-17    0   NA 1.0210526  NA   NA 2018    10-17
## 21994 2018-10-18    0   NA 0.9736842  NA   NA 2018    10-18
## 21995 2018-10-19    0   NA 0.9789474  NA   NA 2018    10-19
## 21996 2018-10-20    0   NA 1.0526316  NA   NA 2018    10-20</code></pre>
<p>Les lignes de codes présentées ci-après permettent de formater la
chronique précédemment créée comme entrées du modèle GR6J et de réaliser
une simulation pluie-débit.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># Data processing for GR6J</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>prep_scen_p0 <span class="ot">&lt;-</span> <span class="fu">PrepGR</span>(<span class="at">DatesR     =</span> ts_scen_p0<span class="sc">$</span>Date,</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>                       <span class="at">Precip     =</span> ts_scen_p0<span class="sc">$</span>Ptot,</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>                       <span class="at">PotEvap    =</span> ts_scen_p0<span class="sc">$</span>Evap, </span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>                       <span class="at">Qobs       =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>                       <span class="at">HydroModel =</span> <span class="st">&quot;GR6J&quot;</span>, </span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>                       <span class="at">CemaNeige  =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co"># Hydrological forecast</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>sim_scen_p0 <span class="ot">&lt;-</span> <span class="fu">SimGR</span>(<span class="at">PrepGR  =</span> prep_scen_p0, </span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>                     <span class="at">WupPer  =</span> per_wup_fcst, </span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a>                     <span class="at">SimPer  =</span> per_fcst,</span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>                     <span class="at">Param   =</span> param_cal_hist,</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a>                     <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning in SimGR(PrepGR = prep_scen_p0, WupPer = per_wup_fcst, SimPer = per_fcst, : &quot;PrepGR&quot; does not contain
## any Qobs values. The efficiency criterion is not computed</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># Simulated streamflow time series</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>ts_sim_scen_p0 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(sim_scen_p0)</span></code></pre></div>
<p>La figure suivante représente les séries de débits observés et
simulés sur la fin de la période de calage, et le résultat de la
simulation du scénario de “précipitations nulles”. On observe la lente
décroissance des débits simulés, générée par la vidange lente des
réservoirs de GR6J.</p>
<p><img src="figure/v02_fig_qscen_p0-1.png" width="98%" /></p>
<p>Il est important de noter que les simulations réalisées jusqu’à
présent ne prennent pas en compte le dernier débit observé. Cela peut
générer une discontinuité dans la séquence des débits, entre les
observations disponibles jusqu’à l’instant de prévision, et les
simulations produites à partir de cet instant. Cette erreur peut être
corrigée de plusieurs manières, en “assimilant” le dernier débit
observé. La correction la plus simple consiste à calculer un simple
ratio entre le dernier débit observé et le débit simulé correspondant et
à utiliser ce ratio pour corriger l’ensemble des débits simulés
suivants. Les lignes de codes présentées ci-après permettent de calculer
un tel ratio, qui sera utilisé par la suite pour corriger les débits
simulés par GR6J, en les divisant par ce ratio (e.g. figure
suivante).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Correction (~ assimilation)</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>corr_qsim <span class="ot">&lt;-</span> ts_sim_scen_p0<span class="sc">$</span>Qsim[<span class="dv">1</span>] <span class="sc">/</span> ts_hist<span class="sc">$</span>Qmmd[<span class="fu">nrow</span>(ts_hist)]</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co"># Ratio display</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>corr_qsim</span></code></pre></div>
<pre><code>## [1] 0.8250818</code></pre>
<p><img src="figure/v02_fig_qscen_p0corr-1.png" width="98%" /></p>
</div>
<div id="scénarios-de-précipitations-futures-non-nulles"
class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Scénarios de
précipitations futures non nulles</h2>
<p>Les lignes de codes ci-dessous permettent de faire des simulations
pluie-débit sur l’été étudié à partir du dernier débit observé en
“rejouant” la climatologie des précipitations, i.e. les précipitations
observées durant les autres étés.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># Historical years</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>year_hist <span class="ot">&lt;-</span> <span class="fu">unique</span>(ts_hist<span class="sc">$</span>Year)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>year_hist <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(year_hist, <span class="fu">unique</span>(ts_fcst<span class="sc">$</span>Year))</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>year_hist</span></code></pre></div>
<pre><code>##  [1] &quot;1999&quot; &quot;2000&quot; &quot;2001&quot; &quot;2002&quot; &quot;2003&quot; &quot;2004&quot; &quot;2005&quot; &quot;2006&quot; &quot;2007&quot; &quot;2008&quot; &quot;2009&quot; &quot;2010&quot; &quot;2011&quot; &quot;2012&quot; &quot;2013&quot;
## [16] &quot;2014&quot; &quot;2015&quot; &quot;2016&quot; &quot;2017&quot;</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># Loop on the historical years</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>ts_qscen_year <span class="ot">&lt;-</span> <span class="fu">sapply</span>(year_hist, <span class="at">FUN =</span> <span class="cf">function</span>(i_year) {</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  </span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  i_ts_hist <span class="ot">&lt;-</span> ts_hist[ts_hist<span class="sc">$</span>Year <span class="sc">==</span> i_year <span class="sc">&amp;</span> ts_hist<span class="sc">$</span>MonthDay <span class="sc">%in%</span> month_day_fcst, ]</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  i_ts_hist<span class="sc">$</span>Date <span class="ot">&lt;-</span> dates_fcst</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  </span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>  <span class="co"># Combine historical and forecasting (based on precipitation climatology) time series</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>  i_ts_scen_py <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ts_hist, i_ts_hist)</span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a>  </span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>  <span class="co"># Data processing for GR6J</span></span>
<span id="cb30-11"><a href="#cb30-11" tabindex="-1"></a>  prep_scen_py <span class="ot">&lt;-</span> <span class="fu">PrepGR</span>(<span class="at">DatesR     =</span> i_ts_scen_py<span class="sc">$</span>Date,</span>
<span id="cb30-12"><a href="#cb30-12" tabindex="-1"></a>                         <span class="at">Precip     =</span> i_ts_scen_py<span class="sc">$</span>Ptot, </span>
<span id="cb30-13"><a href="#cb30-13" tabindex="-1"></a>                         <span class="at">PotEvap    =</span> i_ts_scen_py<span class="sc">$</span>Evap, </span>
<span id="cb30-14"><a href="#cb30-14" tabindex="-1"></a>                         <span class="at">HydroModel =</span> <span class="st">&quot;GR6J&quot;</span>, </span>
<span id="cb30-15"><a href="#cb30-15" tabindex="-1"></a>                         <span class="at">CemaNeige  =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-16"><a href="#cb30-16" tabindex="-1"></a>  </span>
<span id="cb30-17"><a href="#cb30-17" tabindex="-1"></a>  <span class="co"># Hydrological forecast</span></span>
<span id="cb30-18"><a href="#cb30-18" tabindex="-1"></a>  sim_scen_py <span class="ot">&lt;-</span> <span class="fu">SimGR</span>(<span class="at">PrepGR  =</span> prep_scen_py, </span>
<span id="cb30-19"><a href="#cb30-19" tabindex="-1"></a>                       <span class="at">WupPer  =</span> per_wup_fcst, </span>
<span id="cb30-20"><a href="#cb30-20" tabindex="-1"></a>                       <span class="at">SimPer  =</span> per_fcst, </span>
<span id="cb30-21"><a href="#cb30-21" tabindex="-1"></a>                       <span class="at">Param   =</span> param_cal_hist, </span>
<span id="cb30-22"><a href="#cb30-22" tabindex="-1"></a>                       <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-23"><a href="#cb30-23" tabindex="-1"></a>  </span>
<span id="cb30-24"><a href="#cb30-24" tabindex="-1"></a>  <span class="co"># Correction of the simulated streamflow</span></span>
<span id="cb30-25"><a href="#cb30-25" tabindex="-1"></a>  sim_scen_py<span class="sc">$</span>OutputsModel<span class="sc">$</span>Qsim <span class="sc">/</span> corr_qsim</span>
<span id="cb30-26"><a href="#cb30-26" tabindex="-1"></a>  </span>
<span id="cb30-27"><a href="#cb30-27" tabindex="-1"></a>})</span>
<span id="cb30-28"><a href="#cb30-28" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" tabindex="-1"></a><span class="co"># Compute future streamflow quantiles (based on precipitation climatology)</span></span>
<span id="cb30-30"><a href="#cb30-30" tabindex="-1"></a>ts_qscen_quant <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(ts_qscen_year, <span class="at">MARGIN =</span> <span class="dv">1</span>, <span class="at">FUN =</span> <span class="cf">function</span>(x) {</span>
<span id="cb30-31"><a href="#cb30-31" tabindex="-1"></a>  <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">0.90</span>))</span>
<span id="cb30-32"><a href="#cb30-32" tabindex="-1"></a>}))</span>
<span id="cb30-33"><a href="#cb30-33" tabindex="-1"></a>ts_qscen_quant <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(ts_qscen_quant)</span>
<span id="cb30-34"><a href="#cb30-34" tabindex="-1"></a><span class="fu">colnames</span>(ts_qscen_quant) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Q&quot;</span>, <span class="fu">gsub</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">D&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="fu">colnames</span>(ts_qscen_quant)))</span>
<span id="cb30-35"><a href="#cb30-35" tabindex="-1"></a><span class="fu">rownames</span>(ts_qscen_quant) <span class="ot">&lt;-</span> month_day_fcst</span>
<span id="cb30-36"><a href="#cb30-36" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" tabindex="-1"></a><span class="co"># Display of the first calculated quantiles</span></span>
<span id="cb30-38"><a href="#cb30-38" tabindex="-1"></a><span class="fu">head</span>(ts_qscen_quant)</span></code></pre></div>
<pre><code>##             Q10       Q25       Q50       Q75       Q90
## 09-01 0.1090000 0.1090000 0.1090000 0.1090000 0.1090454
## 09-02 0.1095399 0.1095399 0.1095400 0.1095401 0.1112381
## 09-03 0.1077081 0.1077081 0.1077082 0.1078438 0.1095709
## 09-04 0.1065918 0.1065920 0.1065921 0.1071548 0.1099786
## 09-05 0.1055059 0.1055061 0.1055366 0.1069900 0.1132276
## 09-06 0.1044492 0.1044504 0.1046695 0.1082807 0.1156838</code></pre>
<p>La prévision de débits à partir de l’historique des précipitations
semble indiquer que les prochains jours seront secs, et qu’une
augmentation du débit de la La Meuse à Saint-Mihiel n’est a priori
prévue que dans quelques jours.</p>
<p><img src="figure/v02_fig_qscen_py-1.png" width="98%" /></p>
<p>La figure suivante permet de comparer tous les résultats sur un même
graphique. Elle présente les débits observés et simulés sur la fin de la
période de calage, la climatologie des débits sur la période de
prévision, le résultat de la simulation du scénario de “précipitations
nulles”, et les débits basés sur la climatologie des précipitations.</p>
<p><img src="figure/v02_fig_summary-1.png" width="98%" /></p>
</div>
</div>
<div id="références" class="section level1 unnumbered">
<h1 class="unnumbered">Références</h1>
<div id="refs" class="references csl-bib-body hanging-indent"
entry-spacing="0">
<div id="ref-airGRteaching_art" class="csl-entry">
Delaigue, O., P. Brigode, G. Thirel, and L. Coron. 2023. <span>“<span
class="nocase">airGRteaching</span>: An Open-Source Tool for Teaching
Hydrological Modeling with <span>R</span>.”</span> <em>Hydrology and
Earth System Sciences</em> 27 (17): 3293–3327. <a
href="https://doi.org/10.5194/hess-27-3293-2023">https://doi.org/10.5194/hess-27-3293-2023</a>.
</div>
<div id="ref-airGRteaching_man" class="csl-entry">
Delaigue, O., L. Coron, P. Brigode, and G. Thirel. 2024. <em><span
class="nocase">airGRteaching</span>: Teaching Hydrological Modelling
with <span>GR</span> (<span>Shiny</span> Interface Included)</em>. <em>R
News</em>. <a
href="https://doi.org/10.32614/CRAN.package.airGRteaching">https://doi.org/10.32614/CRAN.package.airGRteaching</a>.
</div>
<div id="ref-michel_hydrologie_1991" class="csl-entry">
Michel, C. 1991. <em>Hydrologie Appliquée Aux Petits Bassins
Ruraux</em>. Cemagref, Antony.
</div>
<div id="ref-nash_river_1970" class="csl-entry">
Nash, J. E., and J. V. Sutcliffe. 1970. <span>“River Flow Forecasting
Through Conceptual Models Part <span>I</span> – <span>A</span>
Discussion of Principles.”</span> <em>Journal of Hydrology</em> 10 (3):
282–90. <a
href="https://doi.org/10.1016/0022-1694(70)90255-6">https://doi.org/10.1016/0022-1694(70)90255-6</a>.
</div>
<div id="ref-oudin_which_2005" class="csl-entry">
Oudin, L., F. Hervieu, C. Michel, C. Perrin, V. Andréassian, F. Anctil,
and C. Loumagne. 2005. <span>“Which Potential Evapotranspiration Input
for a Lumped Rainfall–Runoff Model?: <span>Part</span>
2-<span>Towards</span> a Simple and Efficient Potential
Evapotranspiration Model for Rainfall–Runoff Modelling.”</span>
<em>Journal of Hydrology</em> 303 (1–4): 290–306. <a
href="https://doi.org/10.1016/j.jhydrol.2004.08.026">https://doi.org/10.1016/j.jhydrol.2004.08.026</a>.
</div>
<div id="ref-oudin_dynamic_2006" class="csl-entry">
Oudin, Ludovic, Vazken Andréassian, Thibault Mathevet, Charles Perrin,
and Claude Michel. 2006. <span>“Dynamic Averaging of Rainfall-Runoff
Model Simulations from Complementary Model Parameterizations.”</span>
<em>Water Resources Research</em> 42 (7). <a
href="https://doi.org/10.1029/2005WR004636">https://doi.org/10.1029/2005WR004636</a>.
</div>
<div id="ref-pushpalatha_review_2012" class="csl-entry">
Pushpalatha, R., C. Perrin, N. Le Moine, and V. Andréassian. 2012.
<span>“A Review of Efficiency Criteria Suitable for Evaluating Low-Flow
Simulations.”</span> <em>Journal of Hydrology</em> 420–421 (February):
171–82. <a
href="https://doi.org/10.1016/j.jhydrol.2011.11.055">https://doi.org/10.1016/j.jhydrol.2011.11.055</a>.
</div>
<div id="ref-pushpalatha_downward_2011" class="csl-entry">
Pushpalatha, R., C. Perrin, N. Le Moine, T. Mathevet, and V.
Andréassian. 2011. <span>“A Downward Structural Sensitivity Analysis of
Hydrological Models to Improve Low-Flow Simulation.”</span> <em>Journal
of Hydrology</em> 411 (1): 66–76. <a
href="https://doi.org/10.1016/j.jhydrol.2011.09.034">https://doi.org/10.1016/j.jhydrol.2011.09.034</a>.
</div>
</div>
</div>

<footer>
  <div style="float:left"><img src="fig/logo_republique_francaise_CMJN.svg" alt="airGR logo" height=50px style="margin-top:-20px" /></div>
  <div style="float:right">Developed by INRAE&nbsp;<a href="https://webgr.inrae.fr/eng/">Catchment Hydrology Research Group</a>&nbsp;&#x2013; Antony, France</div>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
